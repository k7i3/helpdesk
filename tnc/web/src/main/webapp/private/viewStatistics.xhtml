<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
        >

<ui:composition template="/layout.xhtml">

    <ui:define name="title">
        <p:outputLabel style="font-size: small">
            Статистика
        </p:outputLabel>
    </ui:define>

    <ui:define name="content">
        <p:tabView id="statisticsTabView" dynamic="true" cache="true" style="font-size: small">
            <p:tab title="Статистика">

                <h:panelGrid id="tables" columns="3" style="width:100%">
                    <p:panelGrid columns="2">
                        <f:facet name="header">
                            <h:outputText value="Заявки"/>
                        </f:facet>

                        <h:outputText value="открыта"/>
                        <h:outputText value="#{statisticsController.countOfOpenedTickets}"/>

                        <h:outputText value="принята"/>
                        <h:outputText value="#{statisticsController.countOfAcceptedTickets}"/>

                        <h:outputText value="на выезд"/>
                        <h:outputText value="#{statisticsController.countOfOnServiceTickets}"/>

                        <h:outputText value="закрыта"/>
                        <h:outputText value="#{statisticsController.countOfClosedTickets}"/>

                        <h:outputText value="в архиве"/>
                        <h:outputText value="#{statisticsController.countOfArchivedTickets}"/>

                        <h:outputText value="невалидная"/>
                        <h:outputText value="#{statisticsController.countOfIncorrectTickets}"/>

                        <h:outputText value="отменена"/>
                        <h:outputText value="#{statisticsController.countOfCanceledTickets}"/>

                        <h:outputText value="повторно на выезд"/>
                        <h:outputText value="#{statisticsController.countOfRepeatedOnServiceTickets}"/>

                        <h:outputText value="повторно закрыта"/>
                        <h:outputText value="#{statisticsController.countOfRepeatedClosedTickets}"/>

                        <h:outputText value="всего:"/>
                        <h:outputText value="#{statisticsController.countOfAllTickets}"/>
                    </p:panelGrid>
                    <p:dataTable value="#{statisticsController.countOfTicketsByHeader}" var="countOfTicketsByHeader" style="width: auto">
                    <f:facet name="header">
                        Неисправности
                    </f:facet>
                    <p:column headerText="вид" style="width: auto">
                        <ui:repeat value="#{countOfTicketsByHeader}" var="ticketHeader" offset="0" size="1">
                            <h:outputText value="#{ticketHeader}"/>
                        </ui:repeat>
                    </p:column>
                    <p:column headerText="кол-во" style="width: auto">
                        <ui:repeat value="#{countOfTicketsByHeader}" var="count" offset="1" >
                            <h:outputText value="#{count}"/>
                        </ui:repeat>
                    </p:column>
                </p:dataTable>
                    <p:dataTable value="#{statisticsController.countOfTicketsByResult}" var="countOfTicketsByResult" style="width: auto">
                        <f:facet name="header">
                            Реагирования
                        </f:facet>
                        <p:column headerText="вид" style="width: auto">
                            <ui:repeat value="#{countOfTicketsByResult}" var="ticketResult" offset="0" size="1">
                                <h:outputText value="#{ticketResult}"/>
                            </ui:repeat>
                        </p:column>
                        <p:column headerText="кол-во" style="width: auto">
                            <ui:repeat value="#{countOfTicketsByResult}" var="count" offset="1" >
                                <h:outputText value="#{count}"/>
                            </ui:repeat>
                        </p:column>
                    </p:dataTable>
                </h:panelGrid>

                <!--<p:dataTable value="{statisticsController.countOfTicketsByResults}" var="countOfTicketsByResults" style="width: auto">-->
                <!--<f:facet name="header">-->
                <!--Реагирования-->
                <!--</f:facet>-->
                <!--<p:column headerText="вид" style="width: auto">-->
                <!--<ui:repeat value="{countOfTicketsByResults}" var="ticketResults" offset="0" size="1">-->
                <!--<h:outputText value="{ticketResults}"/>-->
                <!--</ui:repeat>-->
                <!--</p:column>-->
                <!--<p:column headerText="кол-во" style="width: auto">-->
                <!--<ui:repeat value="{countOfTicketsByResults}" var="count" offset="1" >-->
                <!--<h:outputText value="{count}"/>-->
                <!--</ui:repeat>-->
                <!--</p:column>-->
                <!--</p:dataTable>-->

                <h:panelGrid id="charts" columns="3" style="width:100%">
                    <p:panelGrid columns="2" styleClass="ui-noborder" style="width: auto">
                        <p:poll interval="3" update="metergauge" />
                        <p:chart id="metergauge" type="metergauge" model="#{statisticsController.meterGaugeModel}" style="width:400px;height:250px" />
                    </p:panelGrid>
                    <p:chart id="pie" type="pie" model="#{statisticsController.pieModel}" style="width:400px;height:250px" />
                    <p:chart id="bar" type="bar" model="#{statisticsController.barModel}" style="width:400px;" />
                </h:panelGrid>
            </p:tab>

        </p:tabView>
    </ui:define>

</ui:composition>
</html>